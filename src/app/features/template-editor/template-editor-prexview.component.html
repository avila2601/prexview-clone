<div class="prexview-studio h-screen flex flex-col bg-gray-100">
  <!-- Top Menu Bar -->
  <div class="menu-bar bg-gray-50 px-4 py-2 border-b border-gray-200">
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-4">
        <div class="flex items-center space-x-2">
          <div class="w-4 h-4 bg-green-500 rounded-full"></div>
          <span class="text-sm font-medium text-gray-800">DataRender</span>
        </div>
        <div class="text-sm text-gray-600 cursor-pointer hover:text-gray-800">
          Edit
        </div>
        <div class="text-sm text-gray-600 cursor-pointer hover:text-gray-800">
          Window
        </div>
        <div class="text-sm text-gray-600 cursor-pointer hover:text-gray-800">
          Help
        </div>
      </div>

      <div class="flex items-center space-x-1">
        <button
          class="w-3 h-3 bg-yellow-400 rounded-full hover:bg-yellow-500"
        ></button>
        <button
          class="w-3 h-3 bg-green-400 rounded-full hover:bg-green-500"
        ></button>
        <button
          class="w-3 h-3 bg-red-400 rounded-full hover:bg-red-500"
          (click)="goBack()"
        ></button>
      </div>
    </div>
  </div>

  <!-- Navigation Bar -->
  <div class="nav-bar bg-white px-4 py-3 border-b border-gray-200 shadow-sm">
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-4">
        <button mat-icon-button (click)="goBack()" class="w-8 h-8">
          <mat-icon class="text-gray-600">arrow_back</mat-icon>
        </button>

        <div class="flex items-center space-x-3">
          <span
            class="text-sm text-gray-500 uppercase tracking-wide font-medium"
            >TEMPLATE</span
          >
          <input
            class="template-name-input bg-transparent border-none text-lg font-medium text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 rounded px-2 py-1 hover:bg-gray-50"
            [value]="templateName()"
            (input)="updateTemplateName($event)"
            (blur)="autoSave()"
            placeholder="new-template"
          />
        </div>
      </div>

      <div class="flex items-center space-x-1">
        <button
          mat-button
          (click)="saveTemplate()"
          [disabled]="isSaving()"
          class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded font-medium text-sm transition-colors"
        >
          {{ isSaving() ? "SAVING..." : "SAVE" }}
        </button>

        <button
          mat-button
          class="px-3 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm"
        >
          SETTINGS
        </button>

        <button
          mat-button
          class="px-3 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm"
        >
          DOWNLOAD
        </button>

        <div class="w-px h-6 bg-gray-300 mx-1"></div>

        <button
          mat-button
          class="px-3 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm"
        >
          PDF
        </button>

        <button
          mat-button
          class="px-3 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm"
        >
          HTML
        </button>

        <button
          mat-button
          class="px-3 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm"
        >
          PNG
        </button>

        <button
          mat-button
          class="px-3 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm"
        >
          JPG
        </button>

        <div class="w-px h-6 bg-gray-300 mx-2"></div>

        <div class="flex items-center space-x-2">
          <span class="text-sm text-gray-600 font-mono"
            >{{ zoomLevel() }}%</span
          >
          <button mat-icon-button class="w-7 h-7" (click)="zoomOut()">
            <mat-icon class="text-gray-600 text-sm">remove</mat-icon>
          </button>
          <button mat-icon-button class="w-7 h-7" (click)="zoomIn()">
            <mat-icon class="text-gray-600 text-sm">add</mat-icon>
          </button>
          <button mat-icon-button class="w-7 h-7">
            <mat-icon class="text-gray-600 text-sm">fullscreen</mat-icon>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Document Sections Tabs -->
  <div class="sections-tabs bg-white border-b border-gray-200">
    <div class="flex">
      <!-- Left half: Section tabs (matches editor panel width) -->
      <div
        class="w-1/2 flex items-center justify-between border-r border-gray-300"
      >
        <div class="flex">
          <button
            *ngFor="let section of documentSections"
            class="section-tab px-6 py-3 text-sm font-medium border-b-2 transition-colors uppercase tracking-wide"
            [class]="
              currentSection() === section
                ? 'text-blue-600 border-blue-600 bg-blue-50'
                : 'text-gray-600 border-transparent hover:text-gray-900 hover:border-gray-300 hover:bg-gray-50'
            "
            (click)="setCurrentSection(section)"
          >
            {{ section }}
          </button>
        </div>

        <!-- Editor Toolbar aligned to the left within this half -->
        <div class="flex items-center space-x-4 px-4">
          <div class="flex items-center space-x-3">
            <span class="text-sm text-gray-600 font-mono">{{
              currentLine()
            }}</span>
            <span class="text-gray-400">•</span>
            <span class="text-sm text-gray-600"
              >{{ detectedVariables().length }} variables</span
            >
            <span class="text-gray-400">•</span>
            <span class="text-sm text-gray-600"
              >{{ getCurrentSectionContent().length }} chars</span
            >
          </div>
          <div class="flex items-center space-x-1">
            <button mat-icon-button class="w-7 h-7" title="Undo">
              <mat-icon class="text-gray-600 text-sm">undo</mat-icon>
            </button>
            <button mat-icon-button class="w-7 h-7" title="Redo">
              <mat-icon class="text-gray-600 text-sm">redo</mat-icon>
            </button>
            <button mat-icon-button class="w-7 h-7" title="Find">
              <mat-icon class="text-gray-600 text-sm">search</mat-icon>
            </button>
            <button mat-icon-button class="w-7 h-7" title="Replace">
              <mat-icon class="text-gray-600 text-sm">find_replace</mat-icon>
            </button>
          </div>
        </div>
      </div>

      <!-- Right half: Preview toolbar -->
      <div class="w-1/2 flex items-center justify-between px-4 py-2">
        <div class="flex items-center space-x-3">
          <span class="text-sm text-gray-700 font-medium"
            >Document Preview</span
          >
          <div class="flex items-center space-x-2">
            <div
              class="w-2 h-2 rounded-full"
              [class]="previewHtml() ? 'bg-green-500' : 'bg-red-500'"
            ></div>
            <span class="text-xs text-gray-500 font-medium">
              {{ previewHtml() ? "Rendered" : "Error" }}
            </span>
          </div>
        </div>

        <div class="flex items-center space-x-1">
          <button
            mat-icon-button
            class="w-7 h-7"
            (click)="updatePreview()"
            title="Refresh Preview"
          >
            <mat-icon class="text-gray-600 text-sm">refresh</mat-icon>
          </button>
          <button mat-icon-button class="w-7 h-7" title="Fullscreen Preview">
            <mat-icon class="text-gray-600 text-sm">fullscreen</mat-icon>
          </button>
          <button mat-icon-button class="w-7 h-7" title="Export Preview">
            <mat-icon class="text-gray-600 text-sm">download</mat-icon>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="main-content flex-1 flex overflow-hidden">
    <!-- Left Editor Panel -->
    <div
      class="editor-panel w-1/2 flex flex-col border-r border-gray-300 bg-white"
    >
      <!-- Monaco Editor -->
      <div class="monaco-container flex-1 relative bg-gray-900">
        <div #monacoEditor class="w-full h-full"></div>
      </div>

      <!-- Bottom Data Panel -->
      <div
        class="data-panel h-96 border-t border-gray-300 flex flex-col bg-white"
      >
        <!-- Data Tabs -->
        <div class="data-tabs bg-gray-50 border-b border-gray-200">
          <div class="flex">
            <button
              class="data-tab px-4 py-2 text-sm font-medium border-b-2 transition-colors"
              [class]="
                currentDataTab() === 'xml'
                  ? 'text-blue-600 border-blue-600 bg-white'
                  : 'text-gray-600 border-transparent hover:text-gray-900 hover:bg-gray-100'
              "
              (click)="setCurrentDataTab('xml')"
            >
              XML [SAMPLE DATA]
            </button>
            <button
              class="data-tab px-4 py-2 text-sm font-medium border-b-2 transition-colors"
              [class]="
                currentDataTab() === 'css'
                  ? 'text-blue-600 border-blue-600 bg-white'
                  : 'text-gray-600 border-transparent hover:text-gray-900 hover:bg-gray-100'
              "
              (click)="setCurrentDataTab('css')"
            >
              CSS
            </button>
            <div class="flex-1"></div>
            <button
              mat-button
              class="px-4 py-2 text-sm text-blue-600 hover:text-blue-700 font-medium"
              (click)="viewJson()"
            >
              View JSON
            </button>
          </div>
        </div>

        <!-- Data Content -->
        <div class="data-content flex-1 overflow-hidden bg-gray-900">
          <div
            #dataEditor
            class="w-full h-full"
            *ngIf="currentDataTab() === 'xml'"
          ></div>
          <div
            #cssEditor
            class="w-full h-full"
            *ngIf="currentDataTab() === 'css'"
          ></div>
        </div>
      </div>
    </div>

    <!-- Right Preview Panel -->
    <div class="preview-panel w-1/2 flex flex-col bg-gray-100">
      <!-- Preview Content -->
      <div class="preview-content flex-1 overflow-auto p-6 bg-gray-100">
        <div class="preview-document w-full">
          <!-- Document Preview -->
          <div
            class="document-preview bg-white shadow-xl border border-gray-200 rounded-lg overflow-hidden min-h-96 relative w-full"
            style="padding: 20px"
            [innerHTML]="previewHtml()"
            *ngIf="previewHtml()"
            [style.transform]="'scale(' + zoomLevel() / 100 + ')'"
          ></div>

          <!-- Empty State -->
          <div
            *ngIf="!previewHtml()"
            class="empty-preview flex flex-col items-center justify-center min-h-96 text-gray-400 bg-white rounded-lg border-2 border-dashed border-gray-300"
          >
            <div
              class="w-20 h-20 bg-blue-100 rounded-lg flex items-center justify-center mb-4"
            >
              <mat-icon class="text-3xl text-blue-500">description</mat-icon>
            </div>
            <h3 class="text-lg font-medium text-gray-600 mb-2">
              Document Preview
            </h3>
            <p class="text-sm text-gray-500 text-center max-w-sm mb-4">
              Start editing your template to see the live preview here
            </p>
            <button mat-raised-button color="primary" (click)="updatePreview()">
              Generate Preview
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Variables Indicator - HIDDEN to avoid overlapping with XML editor -->
  <!--
  <div class="variables-indicator absolute bottom-4 left-4 bg-white rounded-lg shadow-lg border border-gray-200 p-3 max-w-sm"
       *ngIf="detectedVariables().length > 0">
    <div class="flex items-center justify-between mb-2">
      <span class="text-sm font-medium text-gray-700">Detected Variables</span>
      <span class="text-xs text-gray-500">{{ detectedVariables().length }}</span>
    </div>
    <div class="flex flex-wrap gap-1">
      <span
        *ngFor="let variable of detectedVariables().slice(0, 5)"
        class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded font-mono">
        {{ '{{' }}{{ variable.name }}{{ '}}' }}
      </span>
      <span
        *ngIf="detectedVariables().length > 5"
        class="text-xs text-gray-500 px-2 py-1">
        +{{ detectedVariables().length - 5 }} more
      </span>
    </div>
  </div>
  -->
</div>
